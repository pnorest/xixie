<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.xixie.dao.coupon.CouponMapper">
    <select id="queryCouponList" resultType="com.example.xixie.model.coupon.Coupon">
        SELECT
            id,
            price,
            NAME,
            create_time AS createTime,
            `status`,
            use_time AS useTime,
            user_id AS userId,
            type
        FROM
            qx_coupon
    </select>

    <insert id="addCoupon">
        INSERT INTO qx_coupon
            (
            price,
            name,
            create_time,
            status,
            user_id,
            type
            )
            VALUES
                (
                #{price},
                #{name},
                now(),
                1,
                #{userId},
                #{type}
                )
    </insert>

    <update id="deleteCoupon">
        UPDATE qx_coupon
        SET `status` = 0
        WHERE
            id =#{id}
    </update>


    <update id="updateCoupon">
        UPDATE qx_coupon
            SET
            last_update_time=now()
            <if test="price !=null">
                ,price=#{price}
            </if>
            <if test="name !=null">
                ,name=#{name}
            </if>
            <if test="status !=null">
                ,status=#{status}
            </if>
            <if test="useTime !=null">
                ,use_time=#{useTime}
            </if>
            <if test="userId !=null">
                ,user_id=#{userId}
            </if>
            <if test="type !=null">
                ,type=#{type}
            </if>
            WHERE
                id =#{id}
    </update>



    <select id="queryCouponListByUser" resultType="com.example.xixie.model.coupon.Coupon">
        SELECT
            id,
            price,
            NAME,
            create_time AS createTime,
            `status`,
            use_time AS useTime,
            user_id AS userId,
            type
        FROM
            qx_coupon where user_id=#{userId}
    </select>


</mapper>
  